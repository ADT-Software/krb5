#!/usr/bin/perl
use Socket qw(:addrinfo);
use strict;

my $hostname;
if ($#ARGV == -1) {
    chop($hostname = `hostname`);
} else {
    $hostname = $ARGV[0];
}

my ($gaerr, @addrs) = getaddrinfo($hostname, "", {flags => AI_CANONNAME});
die "No such host: $hostname ($gaerr)" if $gaerr;
my ($canonname, $addr) = ($addrs[0]->{canonname}, $addrs[0]->{addr});

my ($gnerr, $name, $servicename) = getnameinfo($addr, NI_NAMEREQD);
my $qualname = $gnerr ? $name : $name;

$qualname =~ tr/A-Z/a-z/;	# lowercase our name for keytab use.
print "$qualname\n";
